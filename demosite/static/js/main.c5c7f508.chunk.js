(this["webpackJsonpip-camera-ui"]=this["webpackJsonpip-camera-ui"]||[]).push([[0],{170:function(e,t,a){},171:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(10),i=a.n(s),o=a(13),r=a(38),l=a(11),d=a(102),j=a.n(d),b=a(101),u=a.n(b),m=a(57),h=a(83),f=a.n(h),O=a(84),v=a.n(O),x=a(56),p=a.n(x),g=a(215),N=a(218),w=a(213),C=a(212),S=a(217),k=a(214),E=a(85),y=a.n(E),D=(a(138),a(2)),L=function(){return Object(D.jsx)("div",{className:"loading-style",children:Object(D.jsx)(y.a,{type:"ThreeDots",color:"#444444",height:50,width:50})})},T=a(49),P=a.n(T),I=a(86),A=a.n(I),z=P.a.create({baseURL:"https://sqmfgk98mf.execute-api.cn-northwest-1.amazonaws.com.cn/",headers:{"Content-Type":"application/json"}});z.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),z.interceptors.response.use((function(e){return console.info("response:",e),401===e.status||403===e.status?Promise.reject("401 User Unauthorized"):e?Promise.resolve(e):Promise.reject("response error")}),(function(e){var t,a,c,n,s,i;return console.info("ERR:",e.response),A.a.fire("".concat(e.message),"".concat(null===(t=e.response)||void 0===t||null===(a=t.config)||void 0===a?void 0:a.url," \n ").concat((null===(c=e.response)||void 0===c||null===(n=c.config)||void 0===n?void 0:n.params)?JSON.stringify(null===e||void 0===e||null===(s=e.response)||void 0===s||null===(i=s.config)||void 0===i?void 0:i.params):""),void 0),console.log("-- error --"),console.error(e),console.log("-- error --"),Promise.reject({success:!1,msg:e})}));var F,M,R=z,U=a(216),H=a(104),q=a(210),K=a(96),Q=a.n(K),V=a(87),J=a.n(V),W=a(97),Y=a.n(W),B=a(98),G=a.n(B),X=function(e){var t=e.breadcrumbList,a=e.pageName,n=Object(c.useState)(!1),s=Object(o.a)(n,2),i=s[0],r=s[1];return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"breadcrumb",children:[Object(D.jsx)("div",{className:"icon",children:Object(D.jsx)(J.a,{onClick:function(){r(!1)}})}),Object(D.jsx)("div",{className:"bread",children:Object(D.jsx)(U.a,{separator:Object(D.jsx)(Q.a,{fontSize:"small"}),maxItems:2,"aria-label":"breadcrumb",children:t.map((function(e,t){return e.isLink?Object(D.jsx)(q.a,{color:"inherit",href:e.href,onClick:function(){window.location.href=e.href?e.href:"/#/"},children:e.name},t):Object(D.jsx)(H.a,{color:"textPrimary",children:e.name},t)}))})}),Object(D.jsx)("div",{className:"icon",children:Object(D.jsx)(Y.a,{style:{transform:"rotate(180deg)"}})})]}),"(",i&&Object(D.jsxs)("div",{className:"side-menu",children:[Object(D.jsxs)("div",{className:"title",children:["\u667a\u80fd\u6444\u50cf\u5934\u6f14\u793a"," ",Object(D.jsx)("div",{onClick:function(){r(!1)},className:"close",children:Object(D.jsx)(G.a,{})})]}),Object(D.jsxs)("div",{className:"menu",children:[Object(D.jsx)("div",{children:Object(D.jsx)("a",{className:"DEVICE"===a?"active":"",href:"/#/",children:"\u8bbe\u5907\u7ba1\u7406"})}),Object(D.jsx)("div",{children:Object(D.jsx)("a",{className:"LIVE"===a?"active":"",href:"/#/live",children:"\u76f4\u64ad"})})]})]}),")"]})},Z=a(211),$=a(6),_=Object($.a)({root:{color:"#fff",boxShadow:"none",textTransform:"none",fontSize:14,fontWeight:"bold",padding:"5px 15px",border:"1px solid",backgroundColor:"#EC7211",borderColor:"#EC7211",borderRadius:0,"&:hover":{backgroundColor:"#EC7211",borderColor:"#EC7211",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#EC7211",borderColor:"#EC7211"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(213, 67, 5,.5)"}}})(Z.a),ee=a.p+"static/media/playbg.3be50ee9.png",te=function(){var e=Object(c.useState)({width:0,height:0}),t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(c.useEffect)((function(){function e(){n({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),a},ae=a(43),ce=a.n(ae),ne=600,se=[{name:"\u6700\u8fd13\u5c0f\u65f6",value:10800},{name:"1\u5929\u5185",value:86400},{name:"2\u5929\u5185",value:172800},{name:"7\u5929",value:604800}],ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c="yyyy-MM-DD HH:mm:ss";t&&(c="yyyy-MM-DDTHH:mm");var n=e;return n="string"===typeof e&&e.indexOf("T")<0?new Date(e.replace(/-/g,"/")):new Date(e),0!==a&&(n=n.setSeconds(new Date(n).getSeconds()+a)),ce()(new Date(n)).format(c)},oe=function(e,t){for(var a=[],c=ce()(e),n=ce()(t);c<=n;)a.push(ce()(c).format("YYYY-MM-DD HH:mm:ss")),c=ce()(c).add(ne,"seconds");return a},re=Object(C.a)((function(e){return Object(S.a)({container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1)}})}));!function(e){e.QUICK="quick",e.PRECISE="precise"}(F||(F={})),function(e){e.ALL="all",e.FACE="face"}(M||(M={}));var le=function(e){var t=re(),a=te(),n=e.match.params.id,s=Object(c.useState)([]),i=Object(o.a)(s,2),l=i[0],d=i[1],j=Object(c.useState)(M.ALL),b=Object(o.a)(j,2),u=b[0],h=b[1],O=Object(c.useState)(F.QUICK),x=Object(o.a)(O,2),C=x[0],S=x[1],E=Object(c.useState)(10800),y=Object(o.a)(E,2),T=y[0],P=y[1],I=Object(c.useState)(!1),A=Object(o.a)(I,2),z=A[0],U=A[1],H=Object(c.useState)(0),q=Object(o.a)(H,2),K=q[0],Q=q[1],V=Object(c.useState)(1),J=Object(o.a)(V,2),W=J[0],Y=J[1],B=Object(c.useState)(void 0),G=Object(o.a)(B,2),Z=G[0],$=G[1],ae=Object(c.useState)(!0),ce=Object(o.a)(ae,2),le=ce[0],de=ce[1],je=Object(c.useState)(""),be=Object(o.a)(je,2),ue=be[0],me=be[1],he=Object(c.useState)(ie(new Date,!0,-10800)),fe=Object(o.a)(he,2),Oe=fe[0],ve=fe[1],xe=Object(c.useState)(ie(new Date,!0)),pe=Object(o.a)(xe,2),ge=pe[0],Ne=pe[1],we=ie(new Date,!1,-28800),Ce=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=we,a=T,c=ie(Oe,!1,-28800),s=ie(ge,!1,-28800);if(console.info("loadMore:",e),e){if(!1===le)return}else d([]),U(!0);var i={pageSize:12,type:C,camera:n,interval:ne,currentTime:t,trackTime:a,startTime:c,endTime:s,nextToken:!1===e||!1===le?void 0:Z};R.get("/snapshot?".concat(f.a.stringify(i,{encode:!1}))).then((function(t){U(!1),t.data.nextToken?de(!0):de(!1),e?($(t.data.nextToken),d((function(e){return[].concat(Object(m.a)(e),Object(m.a)(t.data.data))}))):d(t.data.data)})).catch((function(e){console.error(e),U(!1)}))}),[T,Oe,ge,C,le,Z]),Se=Object(c.useCallback)((function(){console.info("loadMoreAllVideoList"),console.info("buildDateStop:",ue);var e=ie(new Date,!1,-28800),t=ie(ue,!1,7200),a=t<e?t:e;if(me(a),console.info("trueNewStopTime:",a),console.info("curDateTime:",e),ue>=e)de(!1);else{var c=oe(ue,a);console.info("loadMoreDateArr:",c);var n=[];c.forEach((function(e,t){t>0&&n.push({faces:"[]",imageData:"",time:e})})),d((function(e){return[].concat(Object(m.a)(e),n)}))}}),[ue]),ke=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e){var t=ie(new Date,!1,-(T+28800)),a=ie(new Date,!1,6600-(T+28800));me(a);var c=oe(t,a),n=[];c.forEach((function(e){n.push({faces:"[]",imageData:"",time:e})})),d(n)}};return Object(c.useEffect)((function(){a.width>768?Q(Math.floor((a.width-100)/5)):Q(Math.floor((a.width-(80+.01*a.width))/3))}),[a]),Object(c.useEffect)((function(){Y(K/1920)}),[K]),Object(c.useEffect)((function(){console.info("videoType:",u),de(!0),$(void 0),d([]),u===M.FACE&&Ce(),u===M.ALL&&ke()}),[u]),Object(D.jsxs)("div",{children:[Object(D.jsx)(X,{breadcrumbList:[{isLink:!1,name:"\u5f55\u50cf\u5217\u8868"}]}),Object(D.jsxs)("div",{className:"content",children:[Object(D.jsxs)("div",{className:"page-title",children:["\u5f55\u50cf\u5217\u8868",Object(D.jsx)("div",{className:"back-button"})]}),Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{className:"no-show",children:"\u9009\u62e9\u60a8\u9700\u8981\u7684\u5f55\u50cf\u7c7b\u578b"}),Object(D.jsx)("div",{className:"no-show",children:Object(D.jsxs)(N.a,{"aria-label":"gender",name:"gender1",value:u,onChange:function(e){h(e.target.value)},children:[Object(D.jsx)(w.a,{value:M.ALL,control:Object(D.jsx)(g.a,{size:"small",color:"primary"}),label:"\u6240\u6709\u5f55\u50cf"}),Object(D.jsx)(w.a,{value:M.FACE,control:Object(D.jsx)(g.a,{size:"small",color:"primary"}),label:"\u6240\u6709\u5305\u542b\u4eba\u8138\u7684\u5f55\u50cf"})]})}),Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"search-tab",children:[Object(D.jsx)("span",{className:p()("tab",{active:C===F.QUICK}),onClick:function(){S(F.QUICK),u===M.FACE&&Ce()},children:"\u5feb\u901f\u67e5\u8be2"}),Object(D.jsx)("span",{className:p()("tab",{active:C===F.PRECISE}),onClick:function(){S(F.PRECISE),u===M.FACE&&Ce()},children:"\u7cbe\u786e\u67e5\u8be2"})]}),Object(D.jsxs)("div",{className:"search-tab-content",children:[C===F.QUICK&&Object(D.jsx)("div",{className:"quick-search-list",children:se.map((function(e,t){return Object(D.jsx)("div",{className:p()("quick-search-item",{active:T===e.value}),onClick:function(){de(!0),$(void 0),P(e.value)},children:e.name},t)}))}),C===F.PRECISE&&Object(D.jsxs)("div",{className:"precise-search",children:[Object(D.jsx)("div",{children:Object(D.jsx)(k.a,{size:"small",id:"datetime-local",label:"\u5f00\u59cb\u65f6\u95f4",type:"datetime-local",defaultValue:Oe,className:t.textField,onChange:function(e){ve(e.target.value)},InputProps:{inputProps:{max:ie(new Date(ge),!0)}},InputLabelProps:{shrink:!0}})}),Object(D.jsx)("div",{children:Object(D.jsx)(k.a,{size:"small",id:"datetime-local",label:"\u7ed3\u675f\u65f6\u95f4",type:"datetime-local",defaultValue:ge,className:t.textField,InputProps:{inputProps:{max:ie(new Date,!0)}},onChange:function(e){ve(e.target.value),Ne(e.target.value)},InputLabelProps:{shrink:!0}})})]}),Object(D.jsx)("div",{className:"search",children:Object(D.jsx)(_,{onClick:function(){u===M.FACE&&($(void 0),de(!0),Ce()),u===M.ALL&&ke()},children:"\u641c\u7d22\u8bb0\u5f55"})})]})]})]}),z?Object(D.jsx)("div",{className:"loading",children:Object(D.jsx)(L,{})}):Object(D.jsxs)("div",{className:"ipc-video-list",children:[Object(D.jsx)("div",{className:"result-info",children:"\u641c\u7d22\u7ed3\u679c\uff1a\u67e5\u8be2\u5230\u4ee5\u4e0b\u5f55\u50cf"}),Object(D.jsx)("div",{className:"videos",children:Object(D.jsx)(v.a,{className:"video-more",initialLoad:!1,loadMore:function(){console.info("load More"),u===M.FACE&&Ce(!0),u===M.ALL&&Se()},hasMore:!0,loader:le?Object(D.jsx)("div",{className:"loader",children:"\u52a0\u8f7d\u4e2d ..."},0):Object(D.jsx)("div",{style:{borderTop:"1px solid #eee"},className:"loader",children:"\u6211\u662f\u6709\u5e95\u7ebf\u7684"},1),children:l.map((function(e,t){return Object(D.jsx)("div",{className:"ipc-video",children:Object(D.jsxs)(r.b,{to:"/play/camera/".concat(e.time),children:[Object(D.jsxs)("div",{className:"image",children:[JSON.parse(e.faces).map((function(e,t){var a=(e[0]-20)*W,c=(e[1]-20)*W,n=(e[2]-e[0]+20)*W,s=(e[3]-e[1]+20)*W;return Object(D.jsx)("div",{className:"human",style:{left:a,top:c,width:n,height:s}},t)})),Object(D.jsx)("img",{width:"100%",src:e.imageData?"data:image/jpeg;base64,".concat(e.imageData):ee})]}),Object(D.jsx)("div",{className:"time",children:ie(e.time,!1,28800)})]})},t)}))})})]})]})]})},de=a(99),je=a.n(de),be=Object($.a)({root:{color:"#545b64",boxShadow:"none",textTransform:"none",fontSize:14,fontWeight:"bold",padding:"5px 15px",border:"1px solid",backgroundColor:"#ffffff",borderRadius:0,"&:hover":{backgroundColor:"#ffffff",borderColor:"#545b64",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#ffffff",borderColor:"#545b64"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(255, 255, 255,.5)"}}})(Z.a),ue=function(e){var t=Object(l.f)(),a=e.href,c=e.text;return Object(D.jsx)("div",{className:"back-to-list",children:Object(D.jsx)(be,{onClick:function(){var e=a;t.push({pathname:e})},children:c})})},me=n.a.createContext({address:""}),he=function(e){var t=e.match.params.time,a=ie(t,!1,ne),c=n.a.useContext(me);console.info("config:",c),console.log("newTime",a);var s=t,i=a;return Object(D.jsxs)("div",{children:[Object(D.jsx)(X,{breadcrumbList:[{isLink:!0,name:"\u5f55\u50cf\u5217\u8868",href:"/#/"},{isLink:!1,name:"\u5f55\u50cf\u56de\u653e"}]}),Object(D.jsxs)("div",{className:"content",children:[Object(D.jsxs)("div",{className:"page-title",children:["\u5f55\u50cf\u56de\u770b",Object(D.jsx)("div",{className:"back-button",children:Object(D.jsx)(ue,{href:"/",text:"\u8fd4\u56de\u5217\u8868"})})]}),Object(D.jsxs)("div",{className:"video-replay",children:[Object(D.jsxs)("div",{className:"time",children:[Object(D.jsx)("label",{children:"\u65f6\u95f4:"}),Object(D.jsx)("br",{})," ",ie(t,!1,28800)]}),Object(D.jsxs)("div",{className:"time",children:[Object(D.jsx)("label",{children:"\u65f6\u957f:"})," ",10," \u5206\u949f"]}),Object(D.jsx)(je.a,{autoPlay:!0,height:"auto",width:"100%",controls:!0,url:"".concat(c.address,"?start=").concat(s,"&end=").concat(i)})]})]})]})},fe=a.p+"static/media/logo.e2a890e1.svg",Oe=a(100),ve=a.n(Oe),xe=Object(l.g)((function(e){var t=e.history;return Object(c.useEffect)((function(){var e=t.listen((function(){window.scrollTo(0,0)}));return function(){e()}}),[]),null})),pe=function(){return Object(D.jsx)("div",{className:"App",children:Object(D.jsxs)("div",{className:"app-loading",children:[Object(D.jsx)(L,{}),"Data Transfer Hub is loading..."]})})},ge=function(){var e=Object(c.useState)(!0),t=Object(o.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)({address:""}),i=Object(o.a)(s,2),d=i[0],b=i[1];return Object(c.useEffect)((function(){n(!0);var e=(new Date).getTime();P.a.get("/aws-exports.json?timeStamp="+e).then((function(e){n(!1),b(e.data)}))}),[]),a?Object(D.jsx)(pe,{}):Object(D.jsx)(me.Provider,{value:d,children:Object(D.jsxs)("div",{className:"App",children:[Object(D.jsxs)("div",{className:"ipc-header",children:[Object(D.jsxs)("div",{className:"logo",children:[Object(D.jsx)("img",{width:"20",src:fe}),"\u667a\u80fd\u6444\u50cf\u5934\u6f14\u793a"]}),Object(D.jsx)("div",{className:"user",children:Object(D.jsx)(ve.a,{fontSize:"small"})}),Object(D.jsx)("div",{className:"user",children:"User"})]}),Object(D.jsx)("div",{className:"ipc-body",children:Object(D.jsxs)(r.a,{children:[Object(D.jsx)(xe,{}),Object(D.jsxs)(l.c,{children:[Object(D.jsx)(l.a,{exact:!0,path:"/",component:le}),Object(D.jsx)(l.a,{exact:!0,path:"/play/:id/:time",component:he})]})]})}),Object(D.jsxs)("div",{className:"ipc-footer",children:[Object(D.jsxs)("div",{className:"item",children:[Object(D.jsx)(u.a,{fontSize:"small",className:"icon"}),"Feedback"]}),Object(D.jsxs)("div",{className:"item",children:[Object(D.jsx)(j.a,{fontSize:"small",className:"icon"}),"\u7b80\u4f53\u4e2d\u6587"]})]})]})})},Ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,220)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),c(e),n(e),s(e),i(e)}))};a(170);i.a.render(Object(D.jsx)(n.a.StrictMode,{children:Object(D.jsx)(ge,{})}),document.getElementById("root")),Ne()}},[[171,1,2]]]);
//# sourceMappingURL=main.c5c7f508.chunk.js.map